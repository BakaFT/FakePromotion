var l=["load","loadend","timeout","error","readystatechange","abort"],g="__origin_xhr";function m(e,t){var n={};for(var c in e)n[c]=e[c];return n.target=n.currentTarget=t,n}function O(e,t){t=t||window;var n=t.XMLHttpRequest;t.XMLHttpRequest=function(){for(var i=new n,a=0;a<l.length;++a){var f="on"+l[a];i[f]===void 0&&(i[f]=null)}for(var h in i){var E="";try{E=typeof i[h]}catch{}E==="function"?this[h]=p(h):h!==g&&Object.defineProperty(this,h,{get:c(h),set:y(h),enumerable:!0})}var r=this;i.getProxy=function(){return r},this[g]=i},Object.assign(t.XMLHttpRequest,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4});function c(i){return function(){var a=this.hasOwnProperty(i+"_")?this[i+"_"]:this[g][i],f=(e[i]||{}).getter;return f&&f(a,this)||a}}function y(i){return function(a){var f=this[g],h=this,E=e[i];if(i.substring(0,2)==="on")h[i+"_"]=a,f[i]=function(o){o=m(o,h);var s=e[i]&&e[i].call(h,f,o);s||a.call(h,o)};else{var r=(E||{}).setter;a=r&&r(a,h)||a,this[i+"_"]=a;try{f[i]=a}catch{}}}}function p(i){return function(){var a=[].slice.call(arguments);if(e[i]){var f=e[i].call(this,a,this[g]);if(f)return f}return this[g][i].apply(this[g],a)}}function x(){t.XMLHttpRequest=n,n=void 0}return{originXhr:n,unHook:x}}var S=l[0],k=l[1],A=l[2],D=l[3],T=l[4],N=l[5],R="prototype";function w(e,t){return t=t||window,K(e,t)}function M(e){return e.replace(/^\s+|\s+$/g,"")}function j(e){return e.watcher||(e.watcher=document.createElement("a"))}function H(e,t){var n=e.getProxy(),c="on"+t+"_",y=m({type:t},n);n[c]&&n[c](y);var p;typeof Event=="function"?p=new Event(t,{bubbles:!1}):(p=document.createEvent("Event"),p.initEvent(t,!1,!0)),j(e).dispatchEvent(p)}function _(e){this.xhr=e,this.xhrProxy=e.getProxy()}_[R]=Object.create({resolve:function(t){var n=this.xhrProxy,c=this.xhr;n.readyState=4,c.resHeader=t.headers,n.response=n.responseText=t.response,n.statusText=t.statusText,n.status=t.status,H(c,T),H(c,S),H(c,k)},reject:function(t){this.xhrProxy.status=0,H(this.xhr,t.type),H(this.xhr,k)}});function C(e){function t(n){_.call(this,n)}return t[R]=Object.create(_[R]),t[R].next=e,t}var F=C(function(e){var t=this.xhr;e=e||t.config,t.withCredentials=e.withCredentials,t.open(e.method,e.url,e.async!==!1,e.user,e.password);for(var n in e.headers)t.setRequestHeader(n,e.headers[n]);t.send(e.body)}),I=C(function(e){this.resolve(e)}),G=C(function(e){this.reject(e)});function K(e,t){var n=e.onRequest,c=e.onResponse,y=e.onError;function p(r,o){var s=new I(r),v=o.responseType,u=!v||v==="text"||v==="json"?o.responseText:o.response,d={response:u,status:o.status,statusText:o.statusText,config:r.config,headers:r.resHeader||r.getAllResponseHeaders().split(`\r
`).reduce(function(b,L){if(L==="")return b;var X=L.split(":");return b[X.shift()]=M(X.join(":")),b},{})};if(!c)return s.resolve(d);c(d,s)}function x(r,o,s,v){var u=new G(r);s={config:r.config,error:s,type:v},y?y(s,u):u.next(s)}function i(){return!0}function a(r){return function(o,s){return x(o,this,s,r),!0}}function f(r,o){return r.readyState===4&&r.status!==0?p(r,o):r.readyState!==4&&H(r,T),!0}var{originXhr:h,unHook:E}=O({onload:i,onloadend:i,onerror:a(D),ontimeout:a(A),onabort:a(N),onreadystatechange:function(r){return f(r,this)},open:function(o,s){var v=this,u=s.config={headers:{}};u.method=o[0],u.url=o[1],u.async=o[2],u.user=o[3],u.password=o[4],u.xhr=s;var d="on"+T;if(s[d]||(s[d]=function(){return f(s,v)}),n)return!0},send:function(r,o){var s=o.config;if(s.withCredentials=o.withCredentials,s.body=r[0],n){var v=function(){n(s,new F(o))};return s.async===!1?v():setTimeout(v),!0}},setRequestHeader:function(r,o){if(o.config.headers[r[0].toLowerCase()]=r[1],n)return!0},addEventListener:function(r,o){var s=this;if(l.indexOf(r[0])!==-1){var v=r[1];return j(o).addEventListener(r[0],function(u){var d=m(u,s);d.type=r[0],d.isTrusted=!0,v.call(s,d)}),!0}},getAllResponseHeaders:function(r,o){var s=o.resHeader;if(s){var v="";for(var u in s)v+=u+": "+s[u]+`\r
`;return v}},getResponseHeader:function(r,o){var s=o.resHeader;if(s)return s[(r[0]||"").toLowerCase()]}},t);return{originXhr:h,unProxy:E}}var P=()=>{w({onRequest:(e,t)=>{XHR_HOOKS.filter(n=>typeof n.matcher=="string"&&n.matcher===e.url).forEach(n=>{n.preSend(e)}),t.next(e)},onResponse:(e,t)=>{XHR_HOOKS.filter(n=>typeof n.matcher=="string"&&n.matcher===e.config.url).forEach(n=>{n.postSend(e)}),t.next(e)}})};function Z(e){e.rcp.postInit("rcp-fe-lol-l10n",t=>{P()})}export{Z as init};
